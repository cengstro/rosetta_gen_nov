# Rosetta gen. nov. (Chlorophyta): resolving the identity of red snow algal rosettes
## Casey B. Engstrom, Breanna B. Raymond, Joud Albeitshawish, Anastasia Bogdanovic, Lynne M. Quarmby

<!-- badges: start -->
<!-- badges: end -->


This repository contains all code and data used in the manuscript Rosetta gen. nov. (Chlorophyta): resolving the identity of red snow algal rosettes. All R code makes use of the `here` library, so all scripts should run on any machine without setting the working directory or changing the path to data. 

# Overview of directory structure

## `scripts/`

* `phylogeny/1_sort_fastas.py` contains a python loop to gather entries from multiple fasta files and sort them into three files: rbcL, 18S, and ITS2
* `phylogeny/2_align_fastas.R` uses the `DECIPHER` R library to create and check multiple sequence alignments
* `phylogeny/3_iqtree.sh` is a bash loop to run IQTree for all given alignment files (software must be locally callable from command line). 
* `phylogeny/4_plot_iqtrees.R` uses `ggtree` to plot the phylogenetic trees. 
* `cellcounts.R` processes the cell count morphotype relative abundance data
* `fieldsite_metadata.R` processes the field metadata
* `cell_diam.R` processes the cell diameter measurements and generates Figure S2

## `data/`

* `seq/` contains the raw sequence data. 
  * `single_cell/` contains all Sanger chromatogram trace files and unsorted fastas used in this analysis
  * `x18s_2023-06-24.fasta`, `rbcL_2023-06-24.fasta`, and `its2_2023-06-24.fasta` contain the fasta data sorted by marker output by `phylogeny/1_sort_fastas.py` used in all phylogenetic analysis.
  * `genbank/all_markers_for_tree.fasta` contains all reference data (including ITS2, rbcL, and 18S) included in our phylogenetic analysis
  * `engstrom2020CommonChloroASVs.fasta` contains the ASV sequence data generated by Engstrom et al. 2018 (https://doi.org/10.3389/fmicb.2020.00569), used in current analysis to identify the enigmatic Chloromonas D group. 
* `field_sample_meta/` contains the field sample metadata
* `cellcts/` contains the cell count data
* `cell_diam/` contains the raw cell measurements for each field sample
